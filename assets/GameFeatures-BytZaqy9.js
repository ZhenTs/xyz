import{d as me,c as f,o as g,a as e,e as ie,u as le,r as D,A as B,g as re,G as Y,F as oe,n as de,p as j,t as C,D as Se,l as K,i as ue,f as Ie,H as xe,m as ne,h as $,w as V,j as G,k as ye,I as Ce,J as he,K as be,L as Me,v as De}from"./index-B2ntl-FI.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as ke}from"./Settings-C_A4IUmv.js";import{C as Be}from"./CheckmarkCircle-B_50qmqf.js";import{R as Ue}from"./Refresh-hxtgiIzy.js";import{_ as We}from"./xiaoyugan-Dwisk7G8.js";const Ee={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Oe=e("path",{d:"M480 128a64 64 0 0 0-64-64h-16V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 368 48v16H144V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 112 48v16H96a64 64 0 0 0-64 64v12a4 4 0 0 0 4 4h440a4 4 0 0 0 4-4z",fill:"currentColor"},null,-1),Re=e("path",{d:"M32 416a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V179a3 3 0 0 0-3-3H35a3 3 0 0 0-3 3zm344-208a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24z",fill:"currentColor"},null,-1),ze=[Oe,Re],He=me({name:"Calendar",render:function(n,c){return g(),f("svg",Ee,ze)}}),Ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ae=e("path",{d:"M428 224H288a48 48 0 0 1-48-48V36a4 4 0 0 0-4-4h-92a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h224a64 64 0 0 0 64-64V228a4 4 0 0 0-4-4zm-92 160H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32zm0-80H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32z",fill:"currentColor"},null,-1),Pe=e("path",{d:"M419.22 188.59L275.41 44.78a2 2 0 0 0-3.41 1.41V176a16 16 0 0 0 16 16h129.81a2 2 0 0 0 1.41-3.41z",fill:"currentColor"},null,-1),Le=[Ae,Pe],Ve=me({name:"DocumentText",render:function(n,c){return g(),f("svg",Ne,Le)}}),Ge={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},je=e("circle",{cx:"256",cy:"256",r:"192",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),qe=[je],Je=me({name:"EllipseOutline",render:function(n,c){return g(),f("svg",Ge,qe)}}),Qe="/icons/173746572831736.png",Ke="/icons/174061875626614.png",Xe="/icons/1733492491706152.png",we="/icons/1733492491706148.png",Ye="/icons/1736425783912140.png",Ze="/icons/Ob7pyorzmHiJcbab2c25af264d0758b527bc1b61cc3b.png",Fe={class:"team-status-card"},et={class:"card-header"},tt={class:"team-selector"},st=["disabled","onClick"],at=["disabled"],nt={class:"card-content"},ot={class:"team-display"},it={class:"current-team-info"},lt={class:"team-number"},rt={class:"heroes-container"},ct={key:0,class:"heroes-inline"},ut={class:"hero-circle"},dt=["src","alt"],mt={key:1,class:"hero-placeholder"},pt={class:"hero-name"},gt={key:1,class:"empty-team"},vt={key:2,class:"empty-team"},ft=me({__name:"TeamStatus",setup(te){const n={101:{name:"å¸é©¬æ‡¿",type:"é­å›½"},102:{name:"éƒ­å˜‰",type:"é­å›½"},103:{name:"å…³ç¾½",type:"èœ€å›½"},104:{name:"è¯¸è‘›äº®",type:"èœ€å›½"},105:{name:"å‘¨ç‘œ",type:"å´å›½"},106:{name:"å¤ªå²æ…ˆ",type:"å´å›½"},107:{name:"å•å¸ƒ",type:"ç¾¤é›„"},108:{name:"åä½—",type:"ç¾¤é›„"},109:{name:"ç”„å§¬",type:"é­å›½"},110:{name:"é»„æœˆè‹±",type:"èœ€å›½"},111:{name:"å­™ç­–",type:"å´å›½"},112:{name:"è´¾è¯©",type:"ç¾¤é›„"},113:{name:"æ›¹ä»",type:"é­å›½"},114:{name:"å§œç»´",type:"èœ€å›½"},115:{name:"å­™åš",type:"å´å›½"},116:{name:"å…¬å­™ç“’",type:"ç¾¤é›„"},117:{name:"å…¸éŸ¦",type:"é­å›½"},118:{name:"èµµäº‘",type:"èœ€å›½"},119:{name:"å¤§ä¹”",type:"å´å›½"},120:{name:"å¼ è§’",type:"ç¾¤é›„"},201:{name:"å¾æ™ƒ",type:"é­å›½"},202:{name:"è€å½§",type:"é­å›½"},203:{name:"å…¸éŸ¦",type:"é­å›½"},204:{name:"å¼ é£",type:"èœ€å›½"},205:{name:"èµµäº‘",type:"èœ€å›½"},206:{name:"åºç»Ÿ",type:"èœ€å›½"},207:{name:"é²è‚ƒ",type:"å´å›½"},208:{name:"é™†é€Š",type:"å´å›½"},209:{name:"ç”˜å®",type:"å´å›½"},210:{name:"è²‚è‰",type:"ç¾¤é›„"},211:{name:"è‘£å“",type:"ç¾¤é›„"},212:{name:"å¼ è§’",type:"ç¾¤é›„"},213:{name:"å¼ è¾½",type:"é­å›½"},214:{name:"å¤ä¾¯æƒ‡",type:"é­å›½"},215:{name:"è®¸è¤š",type:"é­å›½"},216:{name:"å¤ä¾¯æ¸Š",type:"é­å›½"},217:{name:"é­å»¶",type:"èœ€å›½"},218:{name:"é»„å¿ ",type:"èœ€å›½"},219:{name:"é©¬è¶…",type:"èœ€å›½"},220:{name:"é©¬å²±",type:"èœ€å›½"},221:{name:"å•è’™",type:"å´å›½"},222:{name:"é»„ç›–",type:"å´å›½"},223:{name:"è”¡æ–‡å§¬",type:"é­å›½"},224:{name:"å°ä¹”",type:"å´å›½"},225:{name:"è¢ç»",type:"ç¾¤é›„"},226:{name:"åé›„",type:"ç¾¤é›„"},227:{name:"é¢œè‰¯",type:"ç¾¤é›„"},228:{name:"æ–‡ä¸‘",type:"ç¾¤é›„"},301:{name:"å‘¨æ³°",type:"å´å›½"},302:{name:"è®¸æ”¸",type:"é­å›½"},303:{name:"äºç¦",type:"é­å›½"},304:{name:"å¼ æ˜Ÿå½©",type:"èœ€å›½"},305:{name:"å…³é“¶å±",type:"èœ€å›½"},306:{name:"å…³å¹³",type:"èœ€å›½"},307:{name:"ç¨‹æ™®",type:"å´å›½"},308:{name:"å¼ æ˜­",type:"å´å›½"},309:{name:"é™†ç»©",type:"å´å›½"},310:{name:"å•ç²ç»®",type:"ç¾¤é›„"},311:{name:"æ½˜å‡¤",type:"ç¾¤é›„"},312:{name:"é‚¢é“è£",type:"ç¾¤é›„"},313:{name:"ç¥èå¤«äºº",type:"ç¾¤é›„"},314:{name:"å­Ÿè·",type:"ç¾¤é›„"}},c=ie(),l=le(),o=D(!1),x=D(!1),S=D(1),I=D([1,2,3,4]),i=B(()=>c.selectedToken?c.getWebSocketStatus(c.selectedToken.id):"disconnected"),k=B(()=>{var a;return((a=c.gameData)==null?void 0:a.presetTeam)??null});function U(a){var pe;if(!a)return{useTeamId:1,teams:{}};const s=a.presetTeamInfo??a,p=J=>{if(!J||typeof J!="object")return null;if(typeof J.useTeamId=="number")return J.useTeamId;for(const F of Object.keys(J)){const L=p(J[F]);if(L)return L}return null},v=s.useTeamId??((pe=s.presetTeamInfo)==null?void 0:pe.useTeamId)??p(s)??1,h=s.presetTeamInfo??s,M={},P=Object.keys(h||{}).filter(J=>/^\d+$/.test(J));for(const J of P){const F=Number(J),L=h[J];if(!L){M[F]={teamInfo:{}};continue}if(L.teamInfo)M[F]={teamInfo:L.teamInfo};else if(L.heroes){const se={};L.heroes.forEach((ae,r)=>{se[String(r+1)]=ae}),M[F]={teamInfo:se}}else if(typeof L=="object"){const se=Object.values(L).some(ae=>ae&&typeof ae=="object"&&"heroId"in ae);M[F]={teamInfo:se?L:{}}}else M[F]={teamInfo:{}}}return{useTeamId:Number(v)||1,teams:M}}const T=B(()=>U(k.value)),Z=B(()=>{var p;const a=(p=T.value.teams[S.value])==null?void 0:p.teamInfo;if(!a)return[];const s=[];for(const[v,h]of Object.entries(a)){const M=(h==null?void 0:h.heroId)??(h==null?void 0:h.id);if(!M)continue;const P=n[Number(M)];s.push({id:Number(M),name:(P==null?void 0:P.name)??`è‹±é›„${M}`,type:(P==null?void 0:P.type)??"",position:Number(v),level:(h==null?void 0:h.level)??1,avatar:h==null?void 0:h.avatar})}return s.sort((v,h)=>v.position-h.position),s}),_=async(a,s,p={},v="",h=8e3)=>{try{return await c.sendMessageWithPromise(a,s,p,h)}catch(M){const P=(M==null?void 0:M.message)??String(M);throw v&&l.error(`${v}å¤±è´¥ï¼š${P}`),M}},b=async(a=!1)=>{var p,v;if(!c.selectedToken)return l.warning("è¯·å…ˆé€‰æ‹©Token"),null;const s=c.selectedToken.id;if(!a){const h=(v=(p=c.gameData)==null?void 0:p.presetTeam)==null?void 0:v.presetTeamInfo;if(h)return h}o.value=!0;try{const h=await _(s,"presetteam_getinfo",{},"è·å–é˜µå®¹ä¿¡æ¯");return c.$patch(M=>{M.gameData={...M.gameData??{},presetTeam:h}}),(h==null?void 0:h.presetTeamInfo)??null}catch(h){return console.error("è·å–é˜µå®¹ä¿¡æ¯å¤±è´¥:",h),null}finally{o.value=!1}},W=()=>{const a=Object.keys(T.value.teams).map(Number).filter(s=>!Number.isNaN(s)).sort((s,p)=>s-p);I.value=a.length?a:[1,2,3,4]},z=()=>{S.value=T.value.useTeamId||1},q=async a=>{if(x.value||o.value)return;if(!c.selectedToken){l.warning("è¯·å…ˆé€‰æ‹©Token");return}const s=S.value;x.value=!0;try{await _(c.selectedToken.id,"presetteam_saveteam",{teamId:a},`åˆ‡æ¢åˆ°é˜µå®¹ ${a}`),S.value=a,l.success(`å·²åˆ‡æ¢åˆ°é˜µå®¹ ${a}`),await O(!0)}catch{S.value=s}finally{x.value=!1}},O=async(a=!1)=>{await b(a)};return re(async()=>{c.selectedToken&&i.value==="connected"?(await O(!1),W(),z(),k.value||(await O(!0),W(),z())):c.selectedToken?console.log("ğŸ›¡ï¸ WebSocketæœªè¿æ¥ï¼Œç­‰å¾…è¿æ¥åè‡ªåŠ¨è·å–é˜Ÿä¼ä¿¡æ¯"):console.log("ğŸ›¡ï¸ æ²¡æœ‰é€‰ä¸­çš„Tokenï¼Œæ— æ³•è·å–é˜Ÿä¼ä¿¡æ¯")}),Y(i,(a,s)=>{console.log(`ğŸ›¡ï¸ WebSocketçŠ¶æ€å˜åŒ–: ${s} -> ${a}`),a==="connected"&&s!=="connected"&&c.selectedToken&&(console.log("ğŸ›¡ï¸ WebSocketå·²è¿æ¥ï¼Œè‡ªåŠ¨è·å–é˜Ÿä¼ä¿¡æ¯"),setTimeout(async()=>{await O(!1),W(),z(),k.value||(await O(!0),W(),z())},1e3))}),Y(()=>c.selectedToken,async(a,s)=>{a&&a.id!==(s==null?void 0:s.id)&&(console.log("ğŸ›¡ï¸ Tokenå·²åˆ‡æ¢ï¼Œé‡æ–°è·å–é˜Ÿä¼ä¿¡æ¯"),c.getWebSocketStatus(a.id)==="connected"&&(await O(!0),W(),z()))}),Y(()=>k.value,()=>{W(),z()},{deep:!0}),(a,s)=>(g(),f("div",Fe,[e("div",et,[s[2]||(s[2]=e("img",{src:Ze,alt:"é˜Ÿä¼å›¾æ ‡",class:"team-icon"},null,-1)),s[3]||(s[3]=e("div",{class:"team-info"},[e("h3",null,"é˜Ÿä¼é˜µå®¹"),e("p",null,"å½“å‰ä½¿ç”¨çš„æˆ˜æ–—é˜µå®¹")],-1)),e("div",tt,[(g(!0),f(oe,null,de(I.value,p=>(g(),f("button",{key:p,disabled:o.value||x.value,class:j(["team-button",{active:S.value===p}]),onClick:v=>q(p)},C(p),11,st))),128)),e("button",{class:"refresh-button",disabled:o.value,title:"åˆ·æ–°é˜Ÿä¼æ•°æ®",onClick:s[0]||(s[0]=p=>O(!0))},[...s[1]||(s[1]=[Se('<svg class="refresh-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-e04fa38a><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-e04fa38a></path><path d="M21 3v5h-5" data-v-e04fa38a></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-e04fa38a></path><path d="M3 21v-5h5" data-v-e04fa38a></path></svg><span class="refresh-text" data-v-e04fa38a>åˆ·æ–°</span>',2)])],8,at)])]),e("div",nt,[e("div",ot,[e("div",it,[s[4]||(s[4]=e("span",{class:"label"},"å½“å‰é˜µå®¹",-1)),e("span",lt,[o.value?(g(),f(oe,{key:1},[K("åŠ è½½ä¸­â€¦")],64)):(g(),f(oe,{key:0},[K("é˜µå®¹ "+C(S.value),1)],64))])]),e("div",rt,[o.value?ue("",!0):(g(),f("div",ct,[(g(!0),f(oe,null,de(Z.value,p=>{var v;return g(),f("div",{key:p.id||p.name,class:"hero-item"},[e("div",ut,[p.avatar?(g(),f("img",{key:0,src:p.avatar,alt:p.name,class:"hero-avatar"},null,8,dt)):(g(),f("div",mt,C(((v=p.name)==null?void 0:v.substring(0,2))||"?"),1))]),e("span",pt,C(p.name||"æœªçŸ¥"),1)])}),128))])),!o.value&&!Z.value.length?(g(),f("div",gt,[...s[5]||(s[5]=[e("p",null,"æš‚æ— é˜Ÿä¼ä¿¡æ¯",-1)])])):ue("",!0),o.value?(g(),f("div",vt,[...s[6]||(s[6]=[e("p",null,"æ­£åœ¨åŠ è½½é˜Ÿä¼ä¿¡æ¯â€¦",-1)])])):ue("",!0)])])])]))}}),_t=ce(ft,[["__scopeId","data-v-e04fa38a"]]),yt="/icons/174023274867420.png",ht={class:"daily-task-container"},kt={class:"task-header"},Tt={class:"header-right"},bt={class:"progress-container"},wt=["disabled"],$t={key:0,class:"loading-text"},St={key:1},It={key:2},xt={class:"modal-header"},Ct={class:"settings-content"},Mt={class:"settings-grid"},Dt={class:"setting-item"},Bt={class:"setting-item"},Ut={class:"setting-item"},Wt={class:"setting-switches"},Et={class:"switch-row"},Ot={class:"switch-row"},Rt={class:"switch-row"},zt={class:"switch-row"},Ht={class:"switch-row"},Nt={class:"switch-row"},At={class:"switch-row"},Pt={class:"modal-header"},Lt=["disabled"],Vt={class:"task-list"},Gt={class:"task-item-left"},jt={class:"task-name"},qt={class:"modal-header"},Jt={class:"log-time"},Te=500,Qt={__name:"DailyTaskStatus",setup(te){const n=ie(),c=le(),l=D(!1),o=D(!1),x=D(!1),S=D(!1),I=D(null),i=Ie({arenaFormation:1,bossFormation:1,bossTimes:4,claimBottle:!0,payRecruit:!0,openBox:!0,arenaEnable:!0,claimHangUp:!0,claimEmail:!0,blackMarketPurchase:!0}),k=D([{id:1,name:"ç™»å½•ä¸€æ¬¡æ¸¸æˆ",completed:!1,loading:!1},{id:2,name:"åˆ†äº«ä¸€æ¬¡æ¸¸æˆ",completed:!1,loading:!1},{id:3,name:"èµ é€å¥½å‹3æ¬¡é‡‘å¸",completed:!1,loading:!1},{id:4,name:"è¿›è¡Œ2æ¬¡æ‹›å‹Ÿ",completed:!1,loading:!1},{id:5,name:"é¢†å–5æ¬¡æŒ‚æœºå¥–åŠ±",completed:!1,loading:!1},{id:6,name:"è¿›è¡Œ3æ¬¡ç‚¹é‡‘",completed:!1,loading:!1},{id:7,name:"å¼€å¯3æ¬¡å®ç®±",completed:!1,loading:!1},{id:12,name:"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“ï¼ˆè¯·è®¾ç½®é‡‡è´­æ¸…å•ï¼‰",completed:!1,loading:!1},{id:13,name:"è¿›è¡Œ1åœºç«æŠ€åœºæˆ˜æ–—",completed:!1,loading:!1},{id:14,name:"æ”¶è·1ä¸ªä»»æ„ç›ç½",completed:!1,loading:!1}]),U=[1,2,3,4].map(r=>({label:`é˜µå®¹${r}`,value:r})),T=[0,1,2,3,4].map(r=>({label:`${r}æ¬¡`,value:r})),Z=B(()=>n.selectedTokenRoleInfo),_=B(()=>{var r,t,y;return((y=(t=(r=Z.value)==null?void 0:r.role)==null?void 0:t.dailyTask)==null?void 0:y.dailyPoint)??0}),b=B(()=>Math.min(_.value,100)),W=B(()=>b.value>=100),z=B(()=>W.value?"#10b981":"#3b82f6"),q=B(()=>n.selectedToken?n.getWebSocketStatus(n.selectedToken.id)==="connected":!1),O=D([]),a=(r,t="info")=>{const y=new Date().toLocaleTimeString();O.value.push({time:y,message:r,type:t}),O.value.length>Te&&O.value.splice(0,O.value.length-Te),Ce(()=>{I.value&&(I.value.scrollTop=I.value.scrollHeight)})},s=r=>{var E,R;if(!((R=(E=r==null?void 0:r.role)==null?void 0:E.dailyTask)!=null&&R.complete)){a("è§’è‰²ä¿¡æ¯ä¸­æ— ä»»åŠ¡å®Œæˆæ•°æ®","warning");return}const t=r.role.dailyTask.complete,y=H=>H===-1;a("å¼€å§‹åŒæ­¥ä»»åŠ¡å®ŒæˆçŠ¶æ€..."),a(`æœåŠ¡å™¨è¿”å›çš„ä»»åŠ¡å®Œæˆæ•°æ®: ${JSON.stringify(t)}`);let d=0,N=0;k.value.forEach(H=>{H.completed=!1}),Object.keys(t).forEach(H=>{const u=Number(H),w=k.value.findIndex(ee=>ee.id===u);if(w>=0){const ee=y(t[H]);k.value[w].completed=ee,d++,ee&&N++,a(`ä»»åŠ¡${u} "${k.value[w].name}": ${ee?"å·²å®Œæˆ":"æœªå®Œæˆ"}`,ee?"success":"info")}else a(`æœåŠ¡å™¨è¿”å›æœªçŸ¥ä»»åŠ¡ID: ${u} (å®Œæˆå€¼: ${t[H]})`,"warning")}),a(`ä»»åŠ¡çŠ¶æ€åŒæ­¥å®Œæˆ: ${N}/${d} å·²å®Œæˆ`),a(`å½“å‰è¿›åº¦: ${_.value}/100`)},p=async()=>{if(!n.selectedToken)throw new Error("æ²¡æœ‰é€‰ä¸­çš„Token");const r=n.selectedToken.id;a("æ­£åœ¨è·å–è§’è‰²ä¿¡æ¯...");try{const t=await n.sendGetRoleInfo(r);return a("è§’è‰²ä¿¡æ¯è·å–æˆåŠŸ","success"),t&&s(t),t}catch(t){throw a(`è·å–è§’è‰²ä¿¡æ¯å¤±è´¥: ${t.message}`,"error"),t}},v=async(r,t,y={},d="",N=8e3)=>{try{d&&a(`æ‰§è¡Œ: ${d}`);const E=await n.sendMessageWithPromise(r,t,y,N);return d&&a(`${d} - æˆåŠŸ`,"success"),E}catch(E){throw d&&a(`${d} - å¤±è´¥: ${E.message}`,"error"),E}},h=r=>{if(!r)return!0;const t=new Date().toDateString(),y=new Date(r).toDateString();return t!==y},M=()=>{const r=[9904,9905,9901,9902,9903,9904,9905],t=new Date().getDay();return r[t]},P=async(r,t,y,d)=>{var N,E,R;try{const H=(E=(N=n.gameData)==null?void 0:N.presetTeam)==null?void 0:E.presetTeamInfo;let u=H==null?void 0:H.useTeamId;if(u)d(`ä»ç¼“å­˜è·å–å½“å‰é˜µå®¹: ${u}`);else{d("ç¼“å­˜ä¸­æ— é˜µå®¹ä¿¡æ¯ï¼Œä»æœåŠ¡å™¨è·å–...");const w=await v(r,"presetteam_getinfo",{},"è·å–é˜µå®¹ä¿¡æ¯");u=(R=w==null?void 0:w.presetTeamInfo)==null?void 0:R.useTeamId,d(`ä»æœåŠ¡å™¨è·å–å½“å‰é˜µå®¹: ${u}`)}return u===t?(d(`å½“å‰å·²æ˜¯${y}${t}ï¼Œæ— éœ€åˆ‡æ¢`,"success"),!1):(d(`å½“å‰é˜µå®¹: ${u}, ç›®æ ‡é˜µå®¹: ${t}ï¼Œå¼€å§‹åˆ‡æ¢...`),await v(r,"presetteam_saveteam",{teamId:t},`åˆ‡æ¢åˆ°${y}${t}`),d(`æˆåŠŸåˆ‡æ¢åˆ°${y}${t}`,"success"),!0)}catch(H){d(`é˜µå®¹æ£€æŸ¥å¤±è´¥ï¼Œç›´æ¥åˆ‡æ¢: ${H.message}`,"warning");try{return await v(r,"presetteam_saveteam",{teamId:t},`å¼ºåˆ¶åˆ‡æ¢åˆ°${y}${t}`),!0}catch(u){throw d(`å¼ºåˆ¶åˆ‡æ¢ä¹Ÿå¤±è´¥: ${u.message}`,"error"),u}}},pe=async(r,t,y)=>{var fe;const d=n.selectedToken.id,N=r==null?void 0:r.role;if(!N)throw new Error("è§’è‰²æ•°æ®ä¸å­˜åœ¨");t("å¼€å§‹æ‰§è¡Œæ¯æ—¥ä»»åŠ¡è¡¥å·®");const E=((fe=N.dailyTask)==null?void 0:fe.complete)??{},R=m=>E[m]===-1,H=N.statistics??{},u=N.statisticsTime??{},w=[];if(R(2)||w.push({name:"åˆ†äº«ä¸€æ¬¡æ¸¸æˆ",execute:()=>v(d,"system_mysharecallback",{isSkipShareCard:!0,type:2},"åˆ†äº«æ¸¸æˆ")}),R(3)||w.push({name:"èµ é€å¥½å‹é‡‘å¸",execute:()=>v(d,"friend_batch",{},"èµ é€å¥½å‹é‡‘å¸")}),R(4)||(w.push({name:"å…è´¹æ‹›å‹Ÿ",execute:()=>v(d,"hero_recruit",{recruitType:3,recruitNumber:1},"å…è´¹æ‹›å‹Ÿ")}),i.payRecruit&&w.push({name:"ä»˜è´¹æ‹›å‹Ÿ",execute:()=>v(d,"hero_recruit",{recruitType:1,recruitNumber:1},"ä»˜è´¹æ‹›å‹Ÿ")})),!R(6)&&h(u["buy:gold"]))for(let m=0;m<3;m++)w.push({name:`å…è´¹ç‚¹é‡‘ ${m+1}/3`,execute:()=>v(d,"system_buygold",{buyNum:1},`å…è´¹ç‚¹é‡‘ ${m+1}`)});if(!R(5)&&i.claimHangUp){for(let m=0;m<4;m++)w.push({name:`æŒ‚æœºåŠ é’Ÿ ${m+1}/4`,execute:()=>v(d,"system_mysharecallback",{isSkipShareCard:!0,type:2},`æŒ‚æœºåŠ é’Ÿ ${m+1}`)});w.push({name:"é¢†å–æŒ‚æœºå¥–åŠ±",execute:()=>v(d,"system_claimhangupreward",{},"é¢†å–æŒ‚æœºå¥–åŠ±")}),w.push({name:"æŒ‚æœºåŠ é’Ÿ 5/5",execute:()=>v(d,"system_mysharecallback",{isSkipShareCard:!0,type:2},"æŒ‚æœºåŠ é’Ÿ 5")})}if(!R(7)&&i.openBox&&w.push({name:"å¼€å¯æœ¨è´¨å®ç®±",execute:()=>v(d,"item_openbox",{itemId:2001,number:10},"å¼€å¯æœ¨è´¨å®ç®±10ä¸ª")}),!R(14)&&i.claimBottle&&w.push({name:"é¢†å–ç›ç½å¥–åŠ±",execute:()=>v(d,"bottlehelper_claim",{},"é¢†å–ç›ç½å¥–åŠ±")}),!R(13)&&i.arenaEnable&&w.push({name:"ç«æŠ€åœºæˆ˜æ–—",execute:async()=>{var m,X;t("å¼€å§‹ç«æŠ€åœºæˆ˜æ–—æµç¨‹"),await P(d,i.arenaFormation,"ç«æŠ€åœºé˜µå®¹",t),await v(d,"arena_startarea",{},"å¼€å§‹ç«æŠ€åœº");for(let Q=1;Q<=3;Q++){t(`ç«æŠ€åœºæˆ˜æ–— ${Q}/3`);const A=await v(d,"arena_getareatarget",{refresh:!1},`è·å–ç«æŠ€åœºç›®æ ‡${Q}`),_e=(X=(m=A==null?void 0:A.roleList)==null?void 0:m[0])==null?void 0:X.roleId;_e?await v(d,"fight_startareaarena",{targetId:_e},`ç«æŠ€åœºæˆ˜æ–—${Q}`,1e4):t(`ç«æŠ€åœºæˆ˜æ–—${Q} - æœªæ‰¾åˆ°ç›®æ ‡`,"warning"),await new Promise($e=>setTimeout($e,1e3))}}}),i.bossTimes>0){const m=H["legion:boss"]??0,X=Math.max(i.bossTimes-m,0);if(X>0){w.push({name:"å†›å›¢BOSSé˜µå®¹æ£€æŸ¥",execute:()=>P(d,i.bossFormation,"BOSSé˜µå®¹",t)});for(let A=0;A<X;A++)w.push({name:`å†›å›¢BOSS ${A+1}/${X}`,execute:()=>v(d,"fight_startlegionboss",{},`å†›å›¢BOSS ${A+1}`,12e3)})}const Q=M();X===0&&w.push({name:"æ¯æ—¥BOSSé˜µå®¹æ£€æŸ¥",execute:()=>P(d,i.bossFormation,"BOSSé˜µå®¹",t)});for(let A=0;A<3;A++)w.push({name:`æ¯æ—¥BOSS ${A+1}/3`,execute:()=>v(d,"fight_startboss",{bossId:Q},`æ¯æ—¥BOSS ${A+1}`,12e3)})}const ee=[{name:"ç¦åˆ©ç­¾åˆ°",cmd:"system_signinreward"},{name:"ä¿±ä¹éƒ¨ç­¾åˆ°",cmd:"legion_signin"},{name:"é¢†å–æ¯æ—¥ç¤¼åŒ…",cmd:"discount_claimreward"},{name:"é¢†å–å…è´¹ç¤¼åŒ…",cmd:"card_claimreward"},{name:"é¢†å–æ°¸ä¹…å¡ç¤¼åŒ…",cmd:"card_claimreward",params:{cardId:4003}}];if(i.claimEmail&&ee.push({name:"é¢†å–é‚®ä»¶å¥–åŠ±",cmd:"mail_claimallattachment"}),ee.forEach(m=>{w.push({name:m.name,execute:()=>v(d,m.cmd,m.params||{},m.name)})}),h(u["artifact:normal:lottery:time"]))for(let m=0;m<3;m++)w.push({name:`å…è´¹é’“é±¼ ${m+1}/3`,execute:()=>v(d,"artifact_lottery",{lotteryNumber:1,newFree:!0,type:1},`å…è´¹é’“é±¼ ${m+1}`)});const ge=["é­å›½","èœ€å›½","å´å›½","ç¾¤é›„"];for(let m=1;m<=4;m++)h(u[`genie:daily:free:${m}`])&&w.push({name:`${ge[m-1]}ç¯ç¥å…è´¹æ‰«è¡`,execute:()=>v(d,"genie_sweep",{genieId:m},`${ge[m-1]}ç¯ç¥å…è´¹æ‰«è¡`)});for(let m=0;m<3;m++)w.push({name:`é¢†å–å…è´¹æ‰«è¡å· ${m+1}/3`,execute:()=>v(d,"genie_buysweep",{},`é¢†å–å…è´¹æ‰«è¡å· ${m+1}`)});!R(12)&&i.blackMarketPurchase&&w.push({name:"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“",execute:()=>v(d,"store_purchase",{goodsId:1},"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“")});for(let m=1;m<=10;m++)w.push({name:`é¢†å–ä»»åŠ¡å¥–åŠ±${m}`,execute:()=>v(d,"task_claimdailypoint",{taskId:m},`é¢†å–ä»»åŠ¡å¥–åŠ±${m}`,5e3)});w.push({name:"é¢†å–æ—¥å¸¸ä»»åŠ¡å¥–åŠ±",execute:()=>v(d,"task_claimdailyreward",{},"é¢†å–æ—¥å¸¸ä»»åŠ¡å¥–åŠ±")},{name:"é¢†å–å‘¨å¸¸ä»»åŠ¡å¥–åŠ±",execute:()=>v(d,"task_claimweekreward",{},"é¢†å–å‘¨å¸¸ä»»åŠ¡å¥–åŠ±")});const ve=w.length;t(`å…±æœ‰ ${ve} ä¸ªä»»åŠ¡å¾…æ‰§è¡Œ`);for(let m=0;m<w.length;m++){const X=w[m];try{await X.execute();const Q=Math.floor((m+1)/ve*100);y&&y(d,Q),await new Promise(A=>setTimeout(A,500))}catch(Q){t(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${X.name} - ${Q.message}`,"error")}}y&&y(d,100),t("æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆ","success"),await new Promise(m=>setTimeout(m,2e3)),await p()},J=async()=>{var r;if(!n.selectedToken||S.value){c.warning("æ²¡æœ‰é€‰ä¸­Tokenæˆ–æ­£åœ¨æ‰§è¡Œä¸­");return}if(!q.value){c.error("WebSocketè¿æ¥æœªå»ºç«‹ï¼Œè¯·æ£€æŸ¥è¿æ¥çŠ¶æ€");return}S.value=!0,x.value=!0,O.value=[];try{a("=== å¼€å§‹æ‰§è¡Œä¸€é”®è¡¥å·®ä»»åŠ¡ ===");const t=await p();if(!(t!=null&&t.role))throw new Error("è·å–è§’è‰²ä¿¡æ¯å¤±è´¥æˆ–æ•°æ®å¼‚å¸¸");a(`å½“å‰æ¯æ—¥ä»»åŠ¡è¿›åº¦: ${((r=t.role.dailyTask)==null?void 0:r.dailyPoint)||0}/100`),a("ç¬¬äºŒæ­¥: å¼€å§‹æ‰§è¡Œæ¯æ—¥ä»»åŠ¡..."),await pe(t,a,(y,d)=>{a(`ä»»åŠ¡è¿›åº¦: ${d}%`)}),a("=== ä»»åŠ¡æ‰§è¡Œå®Œæˆ ===","success"),c.success("æ¯æ—¥ä»»åŠ¡è¡¥å·®æ‰§è¡Œå®Œæˆ"),setTimeout(async()=>{try{await p(),a("æœ€ç»ˆè§’è‰²ä¿¡æ¯åˆ·æ–°å®Œæˆ","success")}catch(y){a(`æœ€ç»ˆåˆ·æ–°å¤±è´¥: ${y.message}`,"warning")}},3e3)}catch(t){a(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${t.message}`,"error"),console.error("è¯¦ç»†é”™è¯¯ä¿¡æ¯:",t),c.error(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${t.message}`)}finally{S.value=!1}},F=async()=>{if(!q.value){c.warning("WebSocketæœªè¿æ¥ï¼Œæ— æ³•åˆ·æ–°ä»»åŠ¡çŠ¶æ€");return}try{a("æ‰‹åŠ¨åˆ·æ–°ä»»åŠ¡çŠ¶æ€..."),await p(),c.success("ä»»åŠ¡çŠ¶æ€åˆ·æ–°æˆåŠŸ")}catch(r){a(`åˆ·æ–°å¤±è´¥: ${r.message}`,"error"),c.error(`åˆ·æ–°å¤±è´¥: ${r.message}`)}},L=()=>n.selectedToken?{roleId:n.selectedToken.id}:null,se=r=>{try{const t=localStorage.getItem(`daily-settings:${r}`);return t?JSON.parse(t):null}catch(t){return console.error("Failed to load settings:",t),null}},ae=(r,t)=>{try{localStorage.setItem(`daily-settings:${r}`,JSON.stringify(t))}catch(y){console.error("Failed to save settings:",y)}};return Y(i,r=>{const t=L();t&&ae(t.roleId,r)},{deep:!0}),Y(()=>n.selectedToken,async(r,t)=>{if(r&&r!==t){a(`åˆ‡æ¢åˆ°Token: ${r.name}`);const y=se(r.id);if(y&&Object.assign(i,y),q.value)try{await p()}catch(d){console.warn("åˆ‡æ¢tokenåè·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",d.message)}}},{immediate:!0}),Y(()=>n.selectedTokenRoleInfo,r=>{var t,y;(y=(t=r==null?void 0:r.role)==null?void 0:t.dailyTask)!=null&&y.complete&&(a("è§’è‰²ä¿¡æ¯æ›´æ–°ï¼ŒåŒæ­¥ä»»åŠ¡çŠ¶æ€"),s(r))},{immediate:!0,deep:!0}),re(async()=>{if(a("ç»„ä»¶åˆå§‹åŒ–å®Œæˆ"),n.selectedToken&&q.value)try{await p()}catch(t){console.warn("åˆå§‹åŒ–æ—¶è·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",t.message)}const r=L();if(r){const t=se(r.roleId);t&&Object.assign(i,t)}}),xe(()=>{a("ç»„ä»¶å³å°†å¸è½½")}),(r,t)=>{const y=ne("n-icon"),d=ne("n-progress"),N=ne("n-select"),E=ne("n-switch"),R=ne("n-modal"),H=ne("n-tag");return g(),f("div",ht,[e("div",kt,[t[16]||(t[16]=e("div",{class:"header-left"},[e("img",{src:yt,alt:"æ¯æ—¥ä»»åŠ¡",class:"task-icon"}),e("div",{class:"title-container"},[e("h3",null,"æ¯æ—¥ä»»åŠ¡"),e("p",null,"å½“å‰è¿›åº¦")])],-1)),e("div",Tt,[e("div",{class:j(["status-indicator",{completed:W.value}]),onClick:t[0]||(t[0]=u=>o.value=!0)},[e("div",{class:j(["status-dot",{completed:W.value}])},null,2),t[15]||(t[15]=e("span",null,"ä»»åŠ¡è¯¦æƒ…",-1))],2),e("button",{class:"settings-button",onClick:t[1]||(t[1]=u=>l.value=!0)},[$(y,null,{default:V(()=>[$(G(ke))]),_:1})])])]),e("div",bt,[$(d,{type:"line",percentage:b.value,height:8,"border-radius":4,color:z.value,"rail-color":"#f3f4f6"},null,8,["percentage","color"])]),t[32]||(t[32]=e("div",{class:"info-container"}," å³ä¸Šè§’å°é½¿è½®æœ‰æƒŠå–œ ",-1)),e("button",{class:"execute-button",disabled:S.value||!q.value,onClick:J},[S.value?(g(),f("span",$t,[...t[17]||(t[17]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),K(" æ‰§è¡Œä¸­... ",-1)])])):q.value?(g(),f("span",It,"ä¸€é”®è¡¥å·®")):(g(),f("span",St,"WebSocketæœªè¿æ¥"))],8,wt),$(R,{show:l.value,"onUpdate:show":t[12]||(t[12]=u=>l.value=u),preset:"card",title:"ä»»åŠ¡è®¾ç½®",style:{width:"400px"}},{header:V(()=>[e("div",xt,[$(y,null,{default:V(()=>[$(G(ke))]),_:1}),t[18]||(t[18]=e("span",null,"ä»»åŠ¡è®¾ç½®",-1))])]),default:V(()=>[e("div",Ct,[e("div",Mt,[e("div",Dt,[t[19]||(t[19]=e("label",{class:"setting-label"},"ç«æŠ€åœºé˜µå®¹",-1)),$(N,{value:i.arenaFormation,"onUpdate:value":t[2]||(t[2]=u=>i.arenaFormation=u),options:G(U),size:"small"},null,8,["value","options"])]),e("div",Bt,[t[20]||(t[20]=e("label",{class:"setting-label"},"BOSSé˜µå®¹",-1)),$(N,{value:i.bossFormation,"onUpdate:value":t[3]||(t[3]=u=>i.bossFormation=u),options:G(U),size:"small"},null,8,["value","options"])]),e("div",Ut,[t[21]||(t[21]=e("label",{class:"setting-label"},"BOSSæ¬¡æ•°",-1)),$(N,{value:i.bossTimes,"onUpdate:value":t[4]||(t[4]=u=>i.bossTimes=u),options:G(T),size:"small"},null,8,["value","options"])]),e("div",Wt,[e("div",Et,[t[22]||(t[22]=e("span",{class:"switch-label"},"é¢†ç½å­",-1)),$(E,{value:i.claimBottle,"onUpdate:value":t[5]||(t[5]=u=>i.claimBottle=u)},null,8,["value"])]),e("div",Ot,[t[23]||(t[23]=e("span",{class:"switch-label"},"é¢†æŒ‚æœº",-1)),$(E,{value:i.claimHangUp,"onUpdate:value":t[6]||(t[6]=u=>i.claimHangUp=u)},null,8,["value"])]),e("div",Rt,[t[24]||(t[24]=e("span",{class:"switch-label"},"ç«æŠ€åœº",-1)),$(E,{value:i.arenaEnable,"onUpdate:value":t[7]||(t[7]=u=>i.arenaEnable=u)},null,8,["value"])]),e("div",zt,[t[25]||(t[25]=e("span",{class:"switch-label"},"å¼€å®ç®±",-1)),$(E,{value:i.openBox,"onUpdate:value":t[8]||(t[8]=u=>i.openBox=u)},null,8,["value"])]),e("div",Ht,[t[26]||(t[26]=e("span",{class:"switch-label"},"é¢†å–é‚®ä»¶å¥–åŠ±",-1)),$(E,{value:i.claimEmail,"onUpdate:value":t[9]||(t[9]=u=>i.claimEmail=u)},null,8,["value"])]),e("div",Nt,[t[27]||(t[27]=e("span",{class:"switch-label"},"é»‘å¸‚è´­ä¹°ç‰©å“",-1)),$(E,{value:i.blackMarketPurchase,"onUpdate:value":t[10]||(t[10]=u=>i.blackMarketPurchase=u)},null,8,["value"])]),e("div",At,[t[28]||(t[28]=e("span",{class:"switch-label"},"ä»˜è´¹æ‹›å‹Ÿ",-1)),$(E,{value:i.payRecruit,"onUpdate:value":t[11]||(t[11]=u=>i.payRecruit=u)},null,8,["value"])])])])])]),_:1},8,["show"]),$(R,{show:o.value,"onUpdate:show":t[13]||(t[13]=u=>o.value=u),preset:"card",title:"æ¯æ—¥ä»»åŠ¡è¯¦æƒ…",style:{width:"400px"}},{header:V(()=>[e("div",Pt,[$(y,null,{default:V(()=>[$(G(He))]),_:1}),t[30]||(t[30]=e("span",null,"æ¯æ—¥ä»»åŠ¡è¯¦æƒ…",-1)),e("button",{class:"refresh-button",disabled:S.value,onClick:F},[$(y,null,{default:V(()=>[$(G(Ue))]),_:1}),t[29]||(t[29]=K(" åˆ·æ–°çŠ¶æ€ ",-1))],8,Lt)])]),default:V(()=>[e("div",Vt,[(g(!0),f(oe,null,de(k.value,u=>(g(),f("div",{key:u.id,class:"task-item"},[e("div",Gt,[$(y,{class:j(["task-status-icon",{completed:u.completed}])},{default:V(()=>[u.completed?(g(),ye(G(Be),{key:0})):(g(),ye(G(Je),{key:1}))]),_:2},1032,["class"]),e("span",jt,C(u.name),1)]),$(H,{type:u.completed?"success":"default",size:"small"},{default:V(()=>[K(C(u.completed?"å·²å®Œæˆ":"æœªå®Œæˆ"),1)]),_:2},1032,["type"])]))),128))])]),_:1},8,["show"]),$(R,{show:x.value,"onUpdate:show":t[14]||(t[14]=u=>x.value=u),preset:"card",title:"ä»»åŠ¡æ‰§è¡Œæ—¥å¿—",style:{width:"500px"}},{header:V(()=>[e("div",qt,[$(y,null,{default:V(()=>[$(G(Ve))]),_:1}),t[31]||(t[31]=e("span",null,"ä»»åŠ¡æ‰§è¡Œæ—¥å¿—",-1))])]),default:V(()=>[e("div",{ref_key:"logContainer",ref:I,class:"log-container"},[(g(!0),f(oe,null,de(O.value,u=>(g(),f("div",{key:u.time+u.message,class:"log-item"},[e("span",Jt,C(u.time),1),e("span",{class:j(["log-message",{error:u.type==="error",success:u.type==="success",warning:u.type==="warning"}])},C(u.message),3)]))),128))],512)]),_:1},8,["show"])])}}},Kt=ce(Qt,[["__scopeId","data-v-7e86c1b9"]]),Xt={class:"tower-status-card"},Yt={class:"card-header"},Zt={class:"energy-display"},Ft={class:"energy-count"},es={class:"card-content"},ts={class:"tower-floor"},ss={class:"floor-number"},as={class:"card-actions"},ns=["disabled"],os={__name:"TowerStatus",setup(te){const n=ie(),c=le(),l=D(!1),o=D(null);D(null);const x=B(()=>{var b;return((b=n.gameData)==null?void 0:b.roleInfo)||null}),S=B(()=>{var q,O;const _=(O=(q=x.value)==null?void 0:q.role)==null?void 0:O.tower;if(!_||!_.id&&_.id!==0)return"0 - 0";const b=_.id,W=Math.floor(b/10)+1,z=b%10+1;return`${W} - ${z}`}),I=B(()=>{var W,z;const _=(z=(W=x.value)==null?void 0:W.role)==null?void 0:z.tower;return(_==null?void 0:_.energy)||0}),i=B(()=>{const _=I.value>0,b=!l.value;return _&&b}),k=async()=>{if(!n.selectedToken){c.warning("è¯·å…ˆé€‰æ‹©Token");return}if(!i.value){c.warning("ä½“åŠ›ä¸è¶³æˆ–æ­£åœ¨çˆ¬å¡”ä¸­");return}o.value&&(clearTimeout(o.value),o.value=null),l.value=!0,o.value=setTimeout(()=>{l.value=!1,o.value=null},15e3);try{const _=n.selectedToken.id;await n.sendMessageWithPromise(_,"fight_starttower",{},1e4),c.success("çˆ¬å¡”å‘½ä»¤å·²å‘é€"),await T(),setTimeout(async()=>{await T(),o.value&&(clearTimeout(o.value),o.value=null),l.value=!1},500)}catch(_){c.error("çˆ¬å¡”å¤±è´¥: "+(_.message||"æœªçŸ¥é”™è¯¯")),o.value&&(clearTimeout(o.value),o.value=null),l.value=!1}},U=()=>{o.value&&(clearTimeout(o.value),o.value=null),l.value=!1,c.info("çˆ¬å¡”çŠ¶æ€å·²é‡ç½®")},T=async()=>{if(!n.selectedToken){console.warn("ğŸ—¼ getTowerInfo: æ²¡æœ‰é€‰ä¸­çš„Token");return}try{const _=n.selectedToken.id;if(n.getWebSocketStatus(_)!=="connected")return;const W=n.sendMessage(_,"role_getroleinfo"),z=n.sendMessage(_,"tower_getinfo");!W&&!z&&console.error("ğŸ—¼ getTowerInfo: æ‰€æœ‰è¯·æ±‚éƒ½å¤±è´¥äº†")}catch(_){console.error("ğŸ—¼ getTowerInfo: è·å–å¡”ä¿¡æ¯å¤±è´¥:",_)}},Z=B(()=>n.selectedToken?n.getWebSocketStatus(n.selectedToken.id):"disconnected");return Y(Z,(_,b)=>{console.log(`ğŸ—¼ WebSocketçŠ¶æ€å˜åŒ–: ${b} -> ${_}`),_==="connected"&&b!=="connected"&&(console.log("ğŸ—¼ WebSocketå·²è¿æ¥ï¼Œè‡ªåŠ¨è·å–å¡”ä¿¡æ¯"),setTimeout(()=>{T()},1e3))}),Y(()=>n.selectedToken,(_,b)=>{_&&_.id!==(b==null?void 0:b.id)&&(console.log("ğŸ—¼ Tokenå·²åˆ‡æ¢ï¼Œè·å–æ–°çš„å¡”ä¿¡æ¯"),n.getWebSocketStatus(_.id)==="connected"&&T())}),Y(()=>n.gameData.towerResult,(_,b)=>{_&&_.timestamp!==(b==null?void 0:b.timestamp)&&(console.log("ğŸ—¼ æ”¶åˆ°æ–°çš„çˆ¬å¡”ç»“æœ:",_),_.success?(c.success("å’¸å°†å¡”æŒ‘æˆ˜æˆåŠŸï¼"),_.autoReward&&setTimeout(()=>{c.success(`è‡ªåŠ¨é¢†å–ç¬¬${_.rewardFloor}å±‚å¥–åŠ±`)},1e3)):c.error("å’¸å°†å¡”æŒ‘æˆ˜å¤±è´¥"),setTimeout(()=>{console.log("ğŸ—¼ çˆ¬å¡”ç»“æœå¤„ç†å®Œæˆï¼Œé‡ç½®çŠ¶æ€"),o.value&&(clearTimeout(o.value),o.value=null),l.value=!1},2e3))},{deep:!0}),re(()=>{n.selectedToken&&n.getWebSocketClient(n.selectedToken.id),n.selectedToken&&Z.value==="connected"?T():n.selectedToken?console.log("ğŸ—¼ WebSocketæœªè¿æ¥ï¼Œç­‰å¾…è¿æ¥åè‡ªåŠ¨è·å–å¡”ä¿¡æ¯"):console.log("ğŸ—¼ æ²¡æœ‰é€‰ä¸­çš„Tokenï¼Œæ— æ³•è·å–å¡”ä¿¡æ¯")}),(_,b)=>(g(),f("div",Xt,[e("div",Yt,[b[1]||(b[1]=e("div",{class:"header-info"},[e("img",{src:we,alt:"çˆ¬å¡”å›¾æ ‡",class:"tower-icon"}),e("div",{class:"tower-info"},[e("h3",null,"å’¸å°†å¡”"),e("p",null,"ä¸€ä¸ªä¸å°å¿ƒå°±è¿‡äº†")])],-1)),e("div",Zt,[b[0]||(b[0]=e("img",{src:We,alt:"å°é±¼å¹²",class:"energy-icon"},null,-1)),e("span",Ft,C(I.value),1)])]),e("div",es,[e("div",ts,[b[2]||(b[2]=e("span",{class:"label"},"å½“å‰å±‚æ•°",-1)),e("span",ss,C(S.value),1)])]),e("div",as,[e("button",{class:j(["climb-button",{active:i.value,disabled:!i.value}]),disabled:!i.value,onClick:k},C(l.value.value?"çˆ¬å¡”ä¸­...":"å¼€å§‹çˆ¬å¡”"),11,ns),l.value.value?(g(),f("button",{key:0,class:"reset-button",onClick:U}," é‡ç½®çŠ¶æ€ ")):ue("",!0)])]))}},is=ce(os,[["__scopeId","data-v-31e6c17b"]]),ls={class:"team-status-card"},rs={class:"card-content"},cs={class:"grid"},us={style:{display:"flex","align-items":"center"}},ds=["src"],ms=me({__name:"ResourceInfo",setup(te){const n=[{itemId:2001,img:"/resource/173365468172811.png",name:""},{itemId:2002,img:"/resource/173349368626923.png",name:""},{itemId:2003,img:"/resource/173349368930929.png",name:""},{itemId:2004,img:"/resource/173349368981430.png",name:""},{itemId:2005,img:"/resource/173349368981431.png",name:""}],c=[{itemId:3007,img:"/resource/1744982743332104.png",name:""},{itemId:3201,img:"/resource/1745048651732168.png",name:""}],l=[{itemId:1011,img:"/resource/17370282349697.png",name:""},{itemId:1012,img:"/resource/17370282344616.png",name:""}],o=[{itemId:1022,img:"/resource/1744982743330101.png",name:""},{itemId:1023,img:"/resource/1745063950300111.png",name:""}],x=ie();le(),D(!1),D(!1),D(1),D([1,2,3,4]);const S=B(()=>x.selectedToken?x.getWebSocketStatus(x.selectedToken.id):"disconnected");B(()=>x.selectedTokenRoleInfo);const I=B(()=>{const i=x.selectedTokenRoleInfo,k=[];if(i&&i.role){const U=i.role.items;k.push({itemId:0,img:"/resource/1744982154749284.png",count:i.role.gold}),k.push({itemId:0,img:"/resource/1744982154832289.png",count:i.role.freeDiamond}),n.forEach(T=>{k.push({itemId:T.itemId,img:T.img,count:U[T.itemId].quantity})}),c.forEach(T=>{k.push({itemId:T.itemId,img:T.img,count:U[T.itemId].quantity})}),l.forEach(T=>{k.push({itemId:T.itemId,img:T.img,count:U[T.itemId].quantity})}),o.forEach(T=>{k.push({itemId:T.itemId,img:T.img,count:U[T.itemId].quantity})})}return k});return re(async()=>{x.selectedToken&&S.value==="connected"||(x.selectedToken?console.log("ğŸ›¡ï¸ WebSocketæœªè¿æ¥ï¼Œç­‰å¾…è¿æ¥åè‡ªåŠ¨è·å–é˜Ÿä¼ä¿¡æ¯"):console.log("ğŸ›¡ï¸ æ²¡æœ‰é€‰ä¸­çš„Tokenï¼Œæ— æ³•è·å–é˜Ÿä¼ä¿¡æ¯"))}),(i,k)=>(g(),f("div",ls,[k[0]||(k[0]=e("div",{class:"card-header"},[e("div",{class:"team-info"},[e("h3",null,"èµ„æºä¿¡æ¯")])],-1)),e("div",rs,[e("div",cs,[(g(!0),f(oe,null,de(I.value,(U,T)=>(g(),f("div",us,[e("img",{src:U.img,style:{width:"30px",height:"30px"}},null,8,ds),K(" "+C(U.count),1)]))),256))])])]))}}),ps=ce(ms,[["__scopeId","data-v-08f7810d"]]),gs={class:"game-status-container"},vs={class:"status-card bottle-helper"},fs={class:"card-header"},_s={class:"card-content"},ys={class:"time-display"},hs={class:"status-card hang-up"},ks={class:"card-header"},Ts={class:"status-info"},bs={class:"card-content"},ws={class:"time-display"},$s={class:"action-row"},Ss=["disabled"],Is={key:0,class:"loading-text"},xs={key:1},Cs=["disabled"],Ms={key:0,class:"loading-text"},Ds={key:1},Bs={class:"status-card legion-match"},Us={class:"card-header"},Ws={class:"card-content"},Es=["disabled"],Os={class:"status-card legion-signin"},Rs={class:"card-header"},zs={class:"card-content"},Hs={key:0,class:"club-name"},Ns={key:1,class:"description"},As=["disabled"],Ps={class:"status-card study"},Ls={class:"card-header"},Vs={class:"card-content"},Gs=["disabled"],js={key:0},qs={key:1,class:"loading-text"},Js={key:0},Qs={key:1},Ks={key:2},Xs={key:3},Ys={key:4},Zs={key:2},Fs={__name:"GameStatus",setup(te){const n=ie(),c=le(),l=D({isRunning:!1,remainingTime:0,stopTime:0}),o=D({isActive:!1,remainingTime:0,elapsedTime:0,lastTime:0,hangUpTime:0,isExtending:!1,isClaiming:!1}),x=D({isRegistered:!1}),S=D({isSignedIn:!1,clubName:""}),I=B(()=>n.gameData.studyStatus),i=B(()=>{var a;return((a=n.gameData)==null?void 0:a.roleInfo)||null}),k=a=>{const s=Math.floor(Number(a)||0);if(s<=0)return"00:00:00";const p=Math.floor(s/3600),v=Math.floor(s%3600/60),h=s%60;return`${p.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},U=()=>{if(!i.value)return;const a=i.value.role;if(a.bottleHelpers){const s=Date.now()/1e3;l.value.stopTime=a.bottleHelpers.helperStopTime,l.value.isRunning=a.bottleHelpers.helperStopTime>s,l.value.remainingTime=Math.max(0,Math.floor(a.bottleHelpers.helperStopTime-s)),console.log("ğŸ¤– ç›ç½æœºå™¨äººçŠ¶æ€æ›´æ–°:",{stopTime:a.bottleHelpers.helperStopTime,now:s,remainingTime:l.value.remainingTime,isRunning:l.value.isRunning})}if(a.hangUp){const s=Date.now()/1e3;o.value.lastTime=a.hangUp.lastTime,o.value.hangUpTime=a.hangUp.hangUpTime;const p=s-o.value.lastTime;p<=o.value.hangUpTime?(o.value.remainingTime=Math.floor(o.value.hangUpTime-p),o.value.isActive=!0):(o.value.remainingTime=0,o.value.isActive=!1),o.value.elapsedTime=Math.floor(o.value.hangUpTime-o.value.remainingTime),console.log("â° æŒ‚æœºçŠ¶æ€æ›´æ–°:",{lastTime:o.value.lastTime,hangUpTime:o.value.hangUpTime,elapsed:p,remainingTime:o.value.remainingTime,elapsedTime:o.value.elapsedTime,isActive:o.value.isActive})}if(a.statistics){const s=new Date;s.setHours(0,0,0,0);const p=s.getTime()/1e3;x.value.isRegistered=Number(a.statistics["last:legion:match:sign:up:time"])>p}if(a.statisticsTime){const s=new Date;s.setHours(0,0,0,0);const p=s.getTime()/1e3;S.value.isSignedIn=a.statisticsTime["legion:sign:in"]>p}};let T=null;const Z=()=>{T&&clearInterval(T),T=setInterval(()=>{l.value.isRunning&&l.value.remainingTime>0&&(l.value.remainingTime=Math.max(0,l.value.remainingTime-1),l.value.remainingTime<=0&&(l.value.isRunning=!1)),o.value.isActive&&o.value.remainingTime>0&&(o.value.remainingTime=Math.max(0,o.value.remainingTime-1),o.value.elapsedTime=o.value.elapsedTime+1,o.value.remainingTime<=0&&(o.value.isActive=!1))},1e3)},_=()=>{if(!n.selectedToken){c.warning("è¯·å…ˆé€‰æ‹©Token");return}const a=n.selectedToken.id;n.sendMessage(a,"bottlehelper_stop"),setTimeout(()=>{n.sendMessage(a,"bottlehelper_start"),n.sendMessage(a,"role_getroleinfo")},500),c.info(l.value.isRunning?"é‡å¯ç›ç½æœºå™¨äºº":"å¯åŠ¨ç›ç½æœºå™¨äºº")},b=async()=>{if(!n.selectedToken){c.warning("è¯·å…ˆé€‰æ‹©Token");return}const a=n.selectedToken.id;try{console.log("ğŸ• å¼€å§‹åŠ é’Ÿæ“ä½œ..."),o.value.isExtending=!0,c.info("æ­£åœ¨åŠ é’Ÿ...");const s=[];for(let p=0;p<4;p++){const v=new Promise(h=>{setTimeout(()=>{console.log(`ğŸ• å‘é€ç¬¬${p+1}æ¬¡åŠ é’Ÿè¯·æ±‚`);const M=n.sendMessage(a,"system_mysharecallback",{isSkipShareCard:!0,type:2});h(M)},p*300)});s.push(v)}await Promise.all(s),console.log("ğŸ• æ‰€æœ‰åŠ é’Ÿè¯·æ±‚å·²å‘é€"),setTimeout(()=>{console.log("ğŸ• åŠ é’Ÿåè·å–æœ€æ–°è§’è‰²ä¿¡æ¯"),n.sendMessage(a,"role_getroleinfo")},1500),setTimeout(()=>{c.success("åŠ é’Ÿæ“ä½œå·²å®Œæˆï¼Œè¯·æŸ¥çœ‹æŒ‚æœºå‰©ä½™æ—¶é—´"),o.value.isExtending=!1},2500)}catch(s){console.error("ğŸ• åŠ é’Ÿæ“ä½œå¤±è´¥:",s),c.error("åŠ é’Ÿæ“ä½œå¤±è´¥: "+(s.message||"æœªçŸ¥é”™è¯¯")),o.value.isExtending=!1}},W=async()=>{if(!n.selectedToken){c.warning("è¯·å…ˆé€‰æ‹©Token");return}const a=n.selectedToken.id;try{console.log("ğŸ å¼€å§‹é¢†å–æŒ‚æœºå¥–åŠ±..."),o.value.isClaiming=!0,c.info("æ­£åœ¨é¢†å–æŒ‚æœºå¥–åŠ±..."),n.sendMessage(a,"system_mysharecallback"),setTimeout(()=>{n.sendMessage(a,"system_claimhangupreward")},200),setTimeout(()=>{n.sendMessage(a,"system_mysharecallback",{isSkipShareCard:!0,type:2})},400),setTimeout(()=>{n.sendMessage(a,"role_getroleinfo")},600),setTimeout(()=>{c.success("æŒ‚æœºå¥–åŠ±é¢†å–å®Œæˆ"),o.value.isClaiming=!1},1200),console.log("ğŸ æŒ‚æœºå¥–åŠ±é¢†å–æ“ä½œåºåˆ—å·²å¯åŠ¨")}catch(s){console.error("ğŸ é¢†å–æŒ‚æœºå¥–åŠ±å¤±è´¥:",s),c.error("é¢†å–æŒ‚æœºå¥–åŠ±å¤±è´¥: "+(s.message||"æœªçŸ¥é”™è¯¯")),o.value.isClaiming=!1}},z=()=>{if(!n.selectedToken||x.value.isRegistered)return;const a=n.selectedToken.id;n.sendMessage(a,"legionmatch_rolesignup"),c.info("æŠ¥åä¿±ä¹éƒ¨æ’ä½")},q=()=>{if(!n.selectedToken||S.value.isSignedIn)return;const a=n.selectedToken.id;n.sendMessage(a,"legion_signin"),n.sendMessage(a,"role_getroleinfo"),c.info("ä¿±ä¹éƒ¨ç­¾åˆ°")},O=async()=>{if(!(!n.selectedToken||I.value.isAnswering)){if(I.value.isCompleted){c.success("âœ… å’¸é±¼å¤§å†²å…³ä»»åŠ¡å·²å®Œæˆï¼Œæ— éœ€é‡å¤ä½œç­”ï¼");return}try{await he();const a=await Me();n.gameData.studyStatus={...n.gameData.studyStatus,isAnswering:!0,questionCount:0,answeredCount:0,status:"starting",timestamp:Date.now()};const s=n.selectedToken.id;n.sendMessage(s,"study_startgame"),setTimeout(()=>{n.gameData.studyStatus.isAnswering&&(n.gameData.studyStatus={...n.gameData.studyStatus,isAnswering:!1,questionCount:0,answeredCount:0,status:"",timestamp:null},c.warning("ç­”é¢˜è¶…æ—¶ï¼Œå·²è‡ªåŠ¨é‡ç½®çŠ¶æ€"))},3e4),c.info(`ğŸš€ å¼€å§‹ä¸€é”®ç­”é¢˜... (é¢˜åº“åŒ…å« ${a} é“é¢˜ç›®)`)}catch(a){console.error("å¯åŠ¨ç­”é¢˜å¤±è´¥:",a),c.error("å¯åŠ¨ç­”é¢˜å¤±è´¥: "+a.message)}}};return Y(i,a=>{a&&U()},{deep:!0,immediate:!0}),re(()=>{if(U(),Z(),he().then(()=>{console.log("ğŸ“š ç­”é¢˜æ•°æ®é¢„åŠ è½½å®Œæˆ")}).catch(a=>{console.error("âŒ ç­”é¢˜æ•°æ®é¢„åŠ è½½å¤±è´¥:",a)}),n.selectedToken){const a=n.selectedToken.id;n.sendMessage(a,"legion_getinfo")}}),be(()=>{T&&clearInterval(T)}),(a,s)=>(g(),f("div",gs,[$(_t),$(Kt),$(is),e("div",vs,[e("div",fs,[s[1]||(s[1]=e("img",{src:Qe,alt:"ç›ç½å›¾æ ‡",class:"status-icon"},null,-1)),s[2]||(s[2]=e("div",{class:"status-info"},[e("h3",null,"ç›ç½æœºå™¨äºº"),e("p",null,"å‰©ä½™æ—¶é—´")],-1)),e("div",{class:j(["status-badge",{active:l.value.isRunning}])},[s[0]||(s[0]=e("div",{class:"status-dot"},null,-1)),e("span",null,C(l.value.isRunning?"è¿è¡Œä¸­":"å·²åœæ­¢"),1)],2)]),e("div",_s,[e("div",ys,C(k(l.value.remainingTime)),1),e("button",{class:j(["action-button",{active:l.value.isRunning}]),onClick:_},C(l.value.isRunning?"é‡å¯æœåŠ¡":"å¯åŠ¨æœåŠ¡"),3)])]),e("div",hs,[e("div",ks,[s[5]||(s[5]=e("img",{src:Ke,alt:"æŒ‚æœºå›¾æ ‡",class:"status-icon"},null,-1)),e("div",Ts,[s[3]||(s[3]=e("h3",null,"æŒ‚æœºæ—¶é—´",-1)),e("p",null,"å·²æŒ‚æœºï¼š"+C(k(o.value.elapsedTime)),1)]),e("div",{class:j(["status-badge",{active:o.value.isActive}])},[s[4]||(s[4]=e("div",{class:"status-dot"},null,-1)),e("span",null,C(o.value.isActive?"æŒ‚æœºä¸­":"å·²å®Œæˆ"),1)],2)]),e("div",bs,[e("div",ws,C(k(o.value.remainingTime)),1),e("div",$s,[e("button",{class:"action-button secondary",disabled:o.value.isExtending,onClick:b},[o.value.isExtending?(g(),f("span",Is,[...s[6]||(s[6]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),K(" åŠ é’Ÿä¸­... ",-1)])])):(g(),f("span",xs,"åŠ é’Ÿ"))],8,Ss),e("button",{class:"action-button primary",disabled:o.value.isClaiming,onClick:W},[o.value.isClaiming?(g(),f("span",Ms,[...s[7]||(s[7]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),K(" é¢†å–ä¸­... ",-1)])])):(g(),f("span",Ds,"é¢†å–å¥–åŠ±"))],8,Cs)])])]),e("div",Bs,[e("div",Us,[s[9]||(s[9]=e("img",{src:Xe,alt:"ä¿±ä¹éƒ¨å›¾æ ‡",class:"status-icon"},null,-1)),s[10]||(s[10]=e("div",{class:"status-info"},[e("h3",null,"ä¿±ä¹éƒ¨æ’ä½"),e("p",null,"èµ›äº‹çŠ¶æ€")],-1)),e("div",{class:j(["status-badge",{active:x.value.isRegistered}])},[s[8]||(s[8]=e("div",{class:"status-dot"},null,-1)),e("span",null,C(x.value.isRegistered?"å·²æŠ¥å":"æœªæŠ¥å"),1)],2)]),e("div",Ws,[s[11]||(s[11]=e("p",{class:"description"},[K(" æ¯é€¢å‘¨ä¸‰å‘¨å››å‘¨äº”æœ‰æ¯”èµ›"),e("br"),K(" ç«‹å³æŠ¥åå‚ä¸ç²¾å½©å¯¹å†³ï¼ ")],-1)),e("button",{class:"action-button",disabled:x.value.isRegistered,onClick:z},C(x.value.isRegistered?"å·²æŠ¥å":"ç«‹å³æŠ¥å"),9,Es)])]),e("div",Os,[e("div",Rs,[s[13]||(s[13]=e("img",{src:we,alt:"ç­¾åˆ°å›¾æ ‡",class:"status-icon"},null,-1)),s[14]||(s[14]=e("div",{class:"status-info"},[e("h3",null,"ä¿±ä¹éƒ¨ç­¾åˆ°"),e("p",null,"æ¯æ—¥ç­¾åˆ°çŠ¶æ€")],-1)),e("div",{class:j(["status-badge",{active:S.value.isSignedIn}])},[s[12]||(s[12]=e("div",{class:"status-dot"},null,-1)),e("span",null,C(S.value.isSignedIn?"å·²ç­¾åˆ°":"å¾…ç­¾åˆ°"),1)],2)]),e("div",zs,[S.value.clubName?(g(),f("p",Hs,[s[15]||(s[15]=K(" å½“å‰ä¿±ä¹éƒ¨",-1)),s[16]||(s[16]=e("br",null,null,-1)),e("strong",null,C(S.value.clubName),1)])):(g(),f("p",Ns," å°šæœªåŠ å…¥ä»»ä½•ä¿±ä¹éƒ¨ ")),e("button",{class:"action-button",disabled:S.value.isSignedIn,onClick:q},C(S.value.isSignedIn?"å·²ç­¾åˆ°":"ç«‹å³ç­¾åˆ°"),9,As)])]),e("div",Ps,[e("div",Ls,[s[18]||(s[18]=e("img",{src:Ye,alt:"å­¦ä¹ å›¾æ ‡",class:"status-icon"},null,-1)),s[19]||(s[19]=e("div",{class:"status-info"},[e("h3",null,"å’¸é±¼å¤§å†²å…³"),e("p",null,"æ¯æ—¥çŸ¥è¯†æŒ‘æˆ˜")],-1)),e("div",{class:j(["status-badge weekly",{completed:I.value.isCompleted}])},[e("div",{class:j(["status-dot",{completed:I.value.isCompleted}])},null,2),s[17]||(s[17]=e("span",null,"æ¯å‘¨ä»»åŠ¡",-1))],2)]),e("div",Vs,[s[21]||(s[21]=e("p",{class:"description"}," æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æŒ¡æˆ‘æ±‚çŸ¥çš„æ¬²æœ›ï¼ ",-1)),e("button",{class:j(["action-button",{completed:I.value.isCompleted}]),disabled:I.value.isAnswering||I.value.isCompleted,onClick:O},[I.value.isCompleted?(g(),f("span",js," âœ… å·²å®Œæˆæ— éœ€ä½œç­” ")):I.value.isAnswering?(g(),f("span",qs,[s[20]||(s[20]=e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1)),I.value.status==="starting"?(g(),f("span",Js,"æ­£åœ¨è·å–é¢˜ç›®...")):I.value.status==="answering"?(g(),f("span",Qs,"ç­”é¢˜ä¸­ "+C(I.value.answeredCount)+"/"+C(I.value.questionCount),1)):I.value.status==="claiming_rewards"?(g(),f("span",Ks,"æ­£åœ¨é¢†å–å¥–åŠ±...")):I.value.status==="completed"?(g(),f("span",Xs,"ç­”é¢˜å®Œæˆ")):(g(),f("span",Ys,"ç­”é¢˜ä¸­..."))])):(g(),f("span",Zs,"ğŸ¯ ä¸€é”®ç­”é¢˜"))],10,Gs)])])]))}},ea=ce(Fs,[["__scopeId","data-v-ceed32af"]]),ta={class:"game-features-page"},sa={class:"page-header"},aa={class:"container"},na={class:"header-content"},oa={class:"header-actions",style:{"justify-content":"center","align-items":"center"}},ia={key:0,style:{display:"flex","flex-direction":"row","align-items":"center"}},la=["src"],ra={style:{"margin-left":"8px","font-size":"14px"}},ca={class:"features-grid-section",style:{"padding-top":"var(--spacing-lg)"}},ua={class:"container"},da={class:"features-grid-section"},ma={class:"container"},pa={__name:"GameFeatures",setup(te){const n=De(),c=le(),l=ie();D(!0),D(null);const o=B(()=>l.selectedToken&&l.getWebSocketStatus(l.selectedToken.id)==="connected"?"connected":"disconnected");B(()=>l.selectedToken?l.getWebSocketStatus(l.selectedToken.id)==="connected"?"å·²è¿æ¥":"æœªè¿æ¥":"æœªé€‰æ‹©Token"),B(()=>o.value==="connected"?"status-connected":"status-disconnected"),B(()=>o.value==="connected");const x=()=>{if(!l.selectedToken){c.warning("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªToken"),n.push("/tokens");return}try{const i=l.selectedToken.id,k=l.selectedToken.token;l.createWebSocketConnection(i,k),c.info("æ­£åœ¨å»ºç«‹ WebSocket è¿æ¥..."),setTimeout(async()=>{l.getWebSocketStatus(i)==="connected"&&(c.success("WebSocket è¿æ¥æˆåŠŸ"),await S())},2e3)}catch(i){console.error("WebSocketè¿æ¥å¤±è´¥:",i),c.error("WebSocketè¿æ¥å¤±è´¥")}};re(()=>{l.selectedToken&&(l.getWebSocketStatus(l.selectedToken.id)!=="connected"?x():S())});const S=async()=>{if(l.selectedToken)try{const i=l.selectedToken.id;console.log("ğŸ® åˆå§‹åŒ–æ¸¸æˆæ•°æ®..."),console.log("ğŸ® æ­£åœ¨è·å–è§’è‰²ä¿¡æ¯...");const k=l.sendMessage(i,"role_getroleinfo");console.log("ğŸ® è§’è‰²ä¿¡æ¯è¯·æ±‚ç»“æœ:",k),console.log("ğŸ® æ­£åœ¨è·å–å¡”ä¿¡æ¯...");const U=l.sendMessage(i,"tower_getinfo");console.log("ğŸ® å¡”ä¿¡æ¯è¯·æ±‚ç»“æœ:",U),console.log("ğŸ® æ­£åœ¨è·å–é˜Ÿä¼ä¿¡æ¯...");const T=l.sendMessage(i,"presetteam_getinfo");console.log("ğŸ® é˜Ÿä¼ä¿¡æ¯è¯·æ±‚ç»“æœ:",T),console.log("ğŸ® æ¸¸æˆæ•°æ®åˆå§‹åŒ–è¯·æ±‚å·²å‘é€")}catch(i){console.warn("åˆå§‹åŒ–æ¸¸æˆæ•°æ®å¤±è´¥:",i)}};be(()=>{});const I=()=>{n.push("/roles")};return(i,k)=>{const U=ne("n-button");return g(),f("div",ta,[e("div",sa,[e("div",aa,[e("div",na,[k[1]||(k[1]=e("div",{class:"header-left"},[e("h1",{class:"page-title"}," æ¸¸æˆåŠŸèƒ½ ")],-1)),e("div",oa,[G(l).gameData.roleInfo&&G(l).gameData.roleInfo.role?(g(),f("div",ia,[e("img",{style:{width:"40px",height:"40px","border-radius":"50%"},src:G(l).gameData.roleInfo.role.headImg},null,8,la),e("text",ra,C(G(l).gameData.roleInfo.role.name),1)])):ue("",!0),$(U,{type:"primary",onClick:I},{default:V(()=>[...k[0]||(k[0]=[K(" åˆ‡æ¢è§’è‰² ",-1)])]),_:1})])])])]),e("div",ca,[e("div",ua,[$(ps)])]),e("div",da,[e("div",ma,[$(ea)])])])}}},ka=ce(pa,[["__scopeId","data-v-0f24a333"]]);export{ka as default};
